{"ast":null,"code":"// < Actions >\n// --------------------------------------------------\nconst SAVE_TOKEN = \"SAVE_TOKEN\";\nconst LOGOUT = \"LOGOUT\"; // < Actions Creators >\n// --------------------------------------------------\n\nfunction saveToken(token) {\n  return {\n    type: SAVE_TOKEN,\n    token\n  };\n}\n\nfunction logout() {\n  return {\n    type: LOGOUT\n  };\n} // < API Actions >\n// --------------------------------------------------\n\n\nfunction defaultLogin(email, password) {\n  return dispatch => {\n    fetch(\"/rest-auth/login/\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        email,\n        password\n      })\n    }).then(response => response.json()).then(json => {\n      if (json.token) {\n        dispatch(saveToken(json.token));\n      }\n    }).catch(err => console.log(err));\n  };\n}\n\nfunction createAccount(email, pw, confirm_pw, img, alias) {\n  return dispatch => {\n    fetch(\"/rest-auth/registration/\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        \"email\": email,\n        \"password1\": pw,\n        \"password2\": confirm_pw // profile_img\t: img,\n        // \"alias\"\t\t: alias\n\n      })\n    }).then(response => response.json()).then(json => {\n      if (json.token) {\n        dispatch(saveToken(json.token));\n      }\n    }).catch(err => console.log(err));\n  };\n} // < Initial State >\n// --------------------------------------------------\n\n\nconst initState = {\n  isLoggedIn: localStorage.getItem(\"jwt\") ? true : false,\n  token: localStorage.getItem(\"jwt\")\n}; // < Reducer >\n// --------------------------------------------------\n\nfunction reducer(state = initState, action) {\n  switch (action.type) {\n    case SAVE_TOKEN:\n      return applySetToken(state, action);\n\n    case LOGOUT:\n      return applyLogout(state, action);\n\n    default:\n      return state;\n  }\n} // < Reducer Functions >\n// --------------------------------------------------\n\n\nfunction applySetToken(state, action) {\n  const {\n    token\n  } = action;\n  localStorage.setItem(\"jwt\", token);\n  console.log(\"set token called\");\n  return { ...state,\n    isLoggedIn: true,\n    token: token\n  };\n}\n\nfunction applyLogout(state, action) {\n  localStorage.removeItem(\"jwt\");\n  return {\n    isLoggedIn: false\n  };\n} // < Exports >\n// --------------------------------------------------\n\n\nconst actionCreators = {\n  defaultLogin,\n  createAccount,\n  logout\n};\nexport { actionCreators }; // export reducer by default\n\nexport default reducer;","map":{"version":3,"sources":["C:/Users/solar/Documents/GitHub/ARCHIVE_SNS/src/redux/modules/account.js"],"names":["SAVE_TOKEN","LOGOUT","saveToken","token","type","logout","defaultLogin","email","password","dispatch","fetch","method","headers","body","JSON","stringify","then","response","json","catch","err","console","log","createAccount","pw","confirm_pw","img","alias","initState","isLoggedIn","localStorage","getItem","reducer","state","action","applySetToken","applyLogout","setItem","removeItem","actionCreators"],"mappings":"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","sourcesContent":["\n// < Actions >\n// --------------------------------------------------\n\nconst SAVE_TOKEN \t= \"SAVE_TOKEN\";\nconst LOGOUT \t\t= \"LOGOUT\";\n\n// < Actions Creators >\n// --------------------------------------------------\n\nfunction saveToken(token) {\n\treturn {\n\t\ttype: SAVE_TOKEN,\n\t\ttoken\n\t};\n}\n\nfunction logout() {\n\treturn {\n\t\ttype: LOGOUT\n\t};\n}\n\n// < API Actions >\n// --------------------------------------------------\n\nfunction defaultLogin(email, password) {\n\treturn dispatch => {\n\t\tfetch(\"/rest-auth/login/\", {\n\t\t\tmethod: \"POST\",\n\t\t\theaders: {\n\t\t\t\t\"Content-Type\": \"application/json\"\n\t\t\t},\n\t\t\tbody: JSON.stringify({\n\t\t\t\temail,\n\t\t\t\tpassword\n\t\t\t})\n\t\t})\n\t\t.then(response => response.json())\n\t\t.then(json => {\n\t\t\tif (json.token) {\n\t\t\t\tdispatch(saveToken(json.token));\n\t\t\t}\n\t\t})\n\t\t.catch(err => console.log(err));\n\t};\n}\n\nfunction createAccount(email, pw, confirm_pw, img, alias) {\n\treturn dispatch => {\n\t\t\n\t\tfetch(\"/rest-auth/registration/\", {\n\t\t\tmethod: \"POST\",\n\t\t\theaders: {\n\t\t\t\t\"Content-Type\": \"application/json\"\n\t\t\t},\n\t\t\tbody: JSON.stringify({\n\t\t\t\t\"email\"\t\t: email,\n\t\t\t\t\"password1\"\t: pw,\n\t\t\t\t\"password2\"\t: confirm_pw,\n\t\t\t\t// profile_img\t: img,\n\t\t\t\t// \"alias\"\t\t: alias\n\t\t\t})\n\t\t})\n\t\t.then(response => response.json())\n\t\t.then(json => {\n\t\t\tif (json.token) {\n\t\t\t\tdispatch(saveToken(json.token));\n\t\t\t}\n\t\t})\n\t\t.catch(err => console.log(err));\n\t};\n}\n\n// < Initial State >\n// --------------------------------------------------\n\nconst initState = {\n\tisLoggedIn: localStorage.getItem(\"jwt\") ? true : false,\n\ttoken: localStorage.getItem(\"jwt\")\n};\n\n// < Reducer >\n// --------------------------------------------------\n\nfunction reducer(state = initState, action) {\n\tswitch(action.type) {\n\t\tcase SAVE_TOKEN:\n\t\t\treturn applySetToken(state, action);\n\t\tcase LOGOUT:\n\t\t\treturn applyLogout(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n}\n\n// < Reducer Functions >\n// --------------------------------------------------\n\nfunction applySetToken(state, action) {\n\tconst { token } = action;\n\tlocalStorage.setItem(\"jwt\", token);\n\n\tconsole.log(\"set token called\");\n\n\treturn {\n\t\t...state,\n\t\tisLoggedIn\t: true,\n\t\ttoken\t\t: token\n\t};\n}\n\nfunction applyLogout(state, action) {\n\tlocalStorage.removeItem(\"jwt\");\n\n\treturn {\n\t\tisLoggedIn: false\n\t};\n}\n\n// < Exports >\n// --------------------------------------------------\n\nconst actionCreators = {\n\tdefaultLogin,\n\tcreateAccount,\n\tlogout,\n};\n\nexport { actionCreators };\n\n// export reducer by default\n\nexport default reducer;\n"]},"metadata":{},"sourceType":"module"}